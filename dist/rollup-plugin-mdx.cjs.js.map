{"version":3,"file":"rollup-plugin-mdx.cjs.js","sources":["../src/index.js"],"sourcesContent":["import path from 'path';\nimport { createFilter } from 'rollup-pluginutils';\nimport mdx from '@mdx-js/mdx';\nimport * as babel from '@babel/core';\n\nconst ext = /\\.md$|\\.mdx$/;\n\nconst DEFAULT_RENDERER = `\nimport React from 'react'\nimport { mdx } from '@mdx-js/react'\n`;\n\n\nexport default function md(options = {}) {\n  const filter = createFilter(options.include, options.exclude);\n  const { renderer = DEFAULT_RENDERER } = options;\n\n  return {\n    name: 'mdx',\n\n    transform(content, filename) {\n      if (!ext.test(filename) || !filter(filename)) {\n        return null;\n      }\n\n      const opts = Object.assign({}, {\n        filepath: path.resolve(filename)\n      }, options);\n\n      return mdx(content, opts).then((result) => {\n        const code = `${renderer}\\n${result}`;\n\n        const { babelOptions = {} } = options;\n\n        const config = babel.loadPartialConfig({ ...babelOptions, filename });\n\n        const transformOptions = config.options;\n\n        const { code: transpiled } = babel.transformSync(code, transformOptions);\n\n        return {\n          code: transpiled,\n          map: { mappings: '' }\n        };\n      });\n    }\n  };\n}\n"],"names":["ext","DEFAULT_RENDERER","md","options","filter","createFilter","include","exclude","renderer","name","transform","content","filename","test","opts","Object","assign","filepath","path","resolve","mdx","then","result","code","babelOptions","config","babel","transformOptions","transpiled","map","mappings"],"mappings":";;;;;;;;;AAKA,MAAMA,GAAG,GAAG,cAAZ;AAEA,MAAMC,gBAAgB,GAAI;;;CAA1B;AAMA,AAAe,SAASC,EAAT,CAAYC,OAAO,GAAG,EAAtB,EAA0B;QACjCC,MAAM,GAAGC,8BAAY,CAACF,OAAO,CAACG,OAAT,EAAkBH,OAAO,CAACI,OAA1B,CAA3B;QACM;IAAEC,QAAQ,GAAGP;MAAqBE,OAAxC;SAEO;IACLM,IAAI,EAAE,KADD;;IAGLC,SAAS,CAACC,OAAD,EAAUC,QAAV,EAAoB;UACvB,CAACZ,GAAG,CAACa,IAAJ,CAASD,QAAT,CAAD,IAAuB,CAACR,MAAM,CAACQ,QAAD,CAAlC,EAA8C;eACrC,IAAP;;;YAGIE,IAAI,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB;QAC7BC,QAAQ,EAAEC,IAAI,CAACC,OAAL,CAAaP,QAAb;OADC,EAEVT,OAFU,CAAb;aAIOiB,GAAG,CAACT,OAAD,EAAUG,IAAV,CAAH,CAAmBO,IAAnB,CAAyBC,MAAD,IAAY;cACnCC,IAAI,GAAI,GAAEf,QAAS,KAAIc,MAAO,EAApC;cAEM;UAAEE,YAAY,GAAG;YAAOrB,OAA9B;cAEMsB,MAAM,GAAGC,uBAAA,CAAwB,EAAE,GAAGF,YAAL;UAAmBZ;SAA3C,CAAf;cAEMe,gBAAgB,GAAGF,MAAM,CAACtB,OAAhC;cAEM;UAAEoB,IAAI,EAAEK;YAAeF,mBAAA,CAAoBH,IAApB,EAA0BI,gBAA1B,CAA7B;eAEO;UACLJ,IAAI,EAAEK,UADD;UAELC,GAAG,EAAE;YAAEC,QAAQ,EAAE;;SAFnB;OAXK,CAAP;;;GAZJ;;;;;"}